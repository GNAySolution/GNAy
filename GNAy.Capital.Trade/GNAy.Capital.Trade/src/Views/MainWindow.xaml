<Window x:Class="GNAy.Capital.Trade.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:GNAy.Capital.Trade"
        mc:Ignorable="d"
        Title="MainWindow" Height="990" Width="1760" Activated="Window_Activated" Closing="Window_Closing" Deactivated="Window_Deactivated" FocusableChanged="Window_FocusableChanged" GotFocus="Window_GotFocus" GotKeyboardFocus="Window_GotKeyboardFocus" GotMouseCapture="Window_GotMouseCapture" IsVisibleChanged="Window_IsVisibleChanged" KeyDown="Window_KeyDown" KeyUp="Window_KeyUp" Loaded="Window_Loaded" LocationChanged="Window_LocationChanged" LostFocus="Window_LostFocus" LostKeyboardFocus="Window_LostKeyboardFocus" LostMouseCapture="Window_LostMouseCapture" MouseDoubleClick="Window_MouseDoubleClick" MouseDown="Window_MouseDown" MouseEnter="Window_MouseEnter" MouseLeave="Window_MouseLeave" MouseLeftButtonDown="Window_MouseLeftButtonDown" MouseLeftButtonUp="Window_MouseLeftButtonUp" MouseMove="Window_MouseMove" MouseRightButtonDown="Window_MouseRightButtonDown" MouseRightButtonUp="Window_MouseRightButtonUp" MouseUp="Window_MouseUp" PreviewMouseWheel="Window_PreviewMouseWheel" SizeChanged="Window_SizeChanged" StateChanged="Window_StateChanged" ToolTipClosing="Window_ToolTipClosing" ToolTipOpening="Window_ToolTipOpening">
    <Grid>
        <!--https://dotblogs.com.tw/clark/2013/03/31/99679-->
        <!--http://www.skcircle.com/?id=1113-->
        <Grid.ColumnDefinitions>
            <ColumnDefinition x:Name="ColumnDef" Width="700"/>
            <ColumnDefinition/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition x:Name="RowDef1" Height="300"/>
            <RowDefinition x:Name="RowDef2" Height="300"/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <GridSplitter Grid.Row="0" Grid.Column="0" Grid.RowSpan="3" HorizontalAlignment="Right" VerticalAlignment="Stretch" Width="6" Background="Blue"/>
        <GridSplitter Grid.Row="0" Grid.Column="0" HorizontalAlignment="Stretch" VerticalAlignment="Bottom" Height="6" Background="Blue"/>
        <GridSplitter Grid.Row="0" Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Bottom" Height="6" Background="Blue"/>
        <GridSplitter Grid.Row="1" Grid.Column="0" HorizontalAlignment="Stretch" VerticalAlignment="Bottom" Height="6" Background="Blue"/>
        <GridSplitter Grid.Row="1" Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Bottom" Height="6" Background="Blue"/>
        <Border Grid.Row="0" Grid.Column="0" Margin="2">
            <Grid Background="#FFE5E5E5">
                <TabControl x:Name="TabControlAA" Margin="0,0,0,30" SelectedIndex="0">
                    <TabItem Header="初始化">
                        <Grid Background="#FFE5E5E5">
                            <Label Content="會員帳號" HorizontalAlignment="Left" Margin="33,6,0,0" VerticalAlignment="Top"/>
                            <TextBox x:Name="TextBoxAccount" Text="" ToolTip="會員帳號" HorizontalAlignment="Left" Margin="91,10,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120"/>
                            <Label Content="會員密碼" HorizontalAlignment="Left" Margin="33,28,0,0" VerticalAlignment="Top"/>
                            <PasswordBox x:Name="DWPBox" ToolTip="會員密碼" HorizontalAlignment="Left" Margin="91,32,0,0" VerticalAlignment="Top" Width="120"/>
                            <Button x:Name="ButtonLoginAccount" Content="登入會員帳號" HorizontalAlignment="Left" Margin="54,54,0,0" VerticalAlignment="Top" Click="ButtonLoginAccount_Click"/>
                            <Button x:Name="ButtonLoginQuote" Content="登入報價元件" HorizontalAlignment="Left" Margin="135,54,0,0" VerticalAlignment="Top" Click="ButtonLoginQuote_Click"/>
                            <Button x:Name="ButtonIsConnected" Content="IsConnected" HorizontalAlignment="Left" Margin="55,78,0,0" VerticalAlignment="Top" Click="ButtonIsConnected_Click"/>
                            <Button x:Name="ButtonDisconnect" Content="Disconnect" HorizontalAlignment="Left" Margin="144,78,0,0" VerticalAlignment="Top" Click="ButtonDisconnect_Click"/>
                            <Button x:Name="ButtonGetProductInfo" Content="商品基本資料" HorizontalAlignment="Left" Margin="54,102,0,0" VerticalAlignment="Top" Click="ButtonGetProductInfo_Click"/>
                            <Button x:Name="ButtonSubQuotes" Content="訂閱即時報價" HorizontalAlignment="Left" Margin="135,102,0,0" VerticalAlignment="Top" Click="ButtonSubQuotes_Click"/>
                            <TextBox x:Name="TextBoxRecoverQuotes" Text="回補報價商品代碼" ToolTip="回補報價商品儲存到檔案" HorizontalAlignment="Left" Margin="10,127,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120"/>
                            <Button x:Name="ButtonRecoverQuotes" Content="回補報價商品" ToolTip="回補報價商品儲存到檔案" HorizontalAlignment="Left" Margin="135,126,0,0" VerticalAlignment="Top" Click="ButtonRecoverQuotes_Click"/>
                            <Button x:Name="ButtonRequestKLine" Content="查詢KLine" HorizontalAlignment="Left" Margin="152,150,0,0" VerticalAlignment="Top" Click="ButtonRequestKLine_Click"/>
                            <TextBox x:Name="TextBoxQuoteFolderTest" Text="報價資料夾測試用" ToolTip="測試儲存報價到此資料夾" HorizontalAlignment="Left" Margin="10,175,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120"/>
                            <Button x:Name="ButtonSaveQuotesTest" Content="儲存報價資料" HorizontalAlignment="Left" Margin="135,174,0,0" VerticalAlignment="Top" Click="ButtonSaveQuotesTest_Click"/>
                            <Button x:Name="ButtonReadCertification" Content="讀取下單憑證" HorizontalAlignment="Left" Margin="216,54,0,0" VerticalAlignment="Top" Click="ButtonReadCertification_Click"/>
                            <Button x:Name="ButtonGetOrderAccs" Content="取得下單帳號" HorizontalAlignment="Left" Margin="297,54,0,0" VerticalAlignment="Top" Click="ButtonGetOrderAccs_Click"/>
                            <Button x:Name="ButtonUnlockOrder" Content="下單解鎖" HorizontalAlignment="Left" Margin="240,78,0,0" VerticalAlignment="Top" Click="ButtonUnlockOrder_Click"/>
                            <Button x:Name="ButtonGetOpenInterest" Content="期權未平倉" HorizontalAlignment="Left" Margin="309,78,0,0" VerticalAlignment="Top" Click="ButtonGetOpenInterest_Click"/>
                        </Grid>
                    </TabItem>
                    <TabItem Header="行事曆">
                        <Grid Background="#FFE5E5E5">
                        </Grid>
                    </TabItem>
                </TabControl>
                <!--https://stackoverflow.com/questions/2311458/wpf-statusbar-is-not-positioned-at-the-bottom-of-the-window-->
                <StatusBar DockPanel.Dock="Bottom" VerticalAlignment="Bottom" Height="28">
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemAA1" Text="AA1"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemAA2" Text="AA2"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemAA3" Text="AA3"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemAA4" Text="AA4"/>
                    </StatusBarItem>
                </StatusBar>
            </Grid>
        </Border>
        <Border Grid.Row="1" Grid.Column="0" Margin="2">
            <Grid Background="#FFE5E5E5">
                <TabControl x:Name="TabControlBA" Margin="0,0,0,30" SelectedIndex="0">
                    <TabItem Header="API回覆">
                        <Grid Background="#FFE5E5E5">
                            <DataGrid x:Name="DataGridAPIReply" Margin="0" AutoGenerateColumns="False" CanUserAddRows="False" SelectionMode="Extended" SelectionUnit="Cell" IsSynchronizedWithCurrentItem="True">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding CreatedTime, StringFormat='{}{0:HH:mm:ss.fff}'}" IsReadOnly="True" CanUserSort="False"/>
                                    <DataGridTextColumn Binding="{Binding ThreadID}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding CallerLineNumber}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding CallerMemberName}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Account}" IsReadOnly="True" CanUserSort="False"/>
                                    <DataGridTextColumn Binding="{Binding Message}" IsReadOnly="True" CanUserSort="False"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>
                </TabControl>
                <StatusBar DockPanel.Dock="Bottom" VerticalAlignment="Bottom" Height="28">
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemBA1" Text="BA1"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemBA2" Text="BA2"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemBA3" Text="BA3"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemBA4" Text="BA4"/>
                    </StatusBarItem>
                </StatusBar>
            </Grid>
        </Border>
        <Border Grid.Row="2" Grid.Column="0" Margin="2">
            <Grid Background="#FFE5E5E5">
                <TabControl x:Name="TabControlCA" Margin="0,0,0,30" SelectedIndex="0">
                    <TabItem Header="AppLog">
                        <Grid Background="#FFE5E5E5">
                            <DataGrid x:Name="DataGridAppLog" Margin="0" AutoGenerateColumns="False" CanUserAddRows="False" SelectionMode="Extended" SelectionUnit="Cell" IsSynchronizedWithCurrentItem="True">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding CreatedTime, StringFormat='{}{0:HH:mm:ss.fff}'}" IsReadOnly="True" CanUserSort="False"/>
                                    <DataGridTextColumn Binding="{Binding Level}" IsReadOnly="True" CanUserSort="False">
                                        <!--https://stackoverflow.com/questions/5549617/change-datagrid-cell-colour-based-on-values-->
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Style.Triggers>
                                                    <Trigger Property="Text" Value="WARN">
                                                        <Setter Property="Background" Value="Khaki"/>
                                                    </Trigger>
                                                    <Trigger Property="Text" Value="ERROR">
                                                        <Setter Property="Background" Value="Pink"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding ThreadID}" IsReadOnly="True" CanUserSort="False">
                                        <!--https://stackoverflow.com/questions/18177153/text-alignment-in-datagrid-->
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding CallerLineNumber}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding CallerMemberName}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Message}" IsReadOnly="True" CanUserSort="False"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>
                </TabControl>
                <StatusBar DockPanel.Dock="Bottom" VerticalAlignment="Bottom" Height="28">
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemCA1" Text="CA1"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemCA2" Text="CA2"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemCA3" Text="CA3"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemCA4" Text="CA4"/>
                    </StatusBarItem>
                </StatusBar>
            </Grid>
        </Border>
        <Border Grid.Row="0" Grid.Column="1" Margin="2">
            <Grid Background="#FFE5E5E5">
                <TabControl x:Name="TabControlAB" Margin="0,0,0,30" SelectedIndex="0">
                    <TabItem Header="一般報價">
                        <Grid Background="#FFE5E5E5">
                            <DataGrid x:Name="DataGridQuoteSubscribed" Margin="0" AutoGenerateColumns="False" CanUserAddRows="False" SelectionMode="Extended" SelectionUnit="Cell" IsSynchronizedWithCurrentItem="True">
                                <DataGrid.RowStyle>
                                    <!--https://stackoverflow.com/questions/18053281/how-to-set-datagrids-row-background-based-on-a-property-value-using-data-bindi-->
                                    <Style TargetType="DataGridRow">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding RowBackground}" Value="1">
                                                <Setter Property="Background" Value="Pink"></Setter>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding RowBackground}" Value="0">
                                                <Setter Property="Background" Value="PaleGreen"></Setter>
                                            </DataTrigger>
                                            <!--試撮-->
                                            <DataTrigger Binding="{Binding RowBackground}" Value="3">
                                                <Setter Property="Background" Value="Plum"></Setter>
                                            </DataTrigger>
                                            <!--試撮-->
                                            <DataTrigger Binding="{Binding RowBackground}" Value="2">
                                                <Setter Property="Background" Value="GreenYellow"></Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGrid.RowStyle>
                                <DataGrid.Columns>
                                    <!--https://blog.csdn.net/yiyi0608/article/details/75597476-->
                                    <DataGridTextColumn Binding="{Binding Page}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Symbol}" IsReadOnly="True" CanUserSort="False"/>
                                    <DataGridTextColumn Binding="{Binding Name}" IsReadOnly="True" CanUserSort="False"/>
                                    <DataGridTextColumn Binding="{Binding MatchedTime, StringFormat='{}{0:HH:mm:ss.ffff}'}" IsReadOnly="True" CanUserSort="False"/>
                                    <DataGridTextColumn Binding="{Binding DealPrice, StringFormat='{}{0:0.00}'}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding DealQty}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding UpDown, StringFormat='{}{0:0.00}'}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding UpDownPct, StringFormat='{}{0:0.00}%'}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding BestBuyPrice, StringFormat='{}{0:0.00}'}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding BestBuyQty}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding BestSellPrice, StringFormat='{}{0:0.00}'}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding BestSellQty}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding OpenPrice, StringFormat='{}{0:0.00}'}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding OpenUpDown, StringFormat='{}{0:0.00}'}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding HighPrice, StringFormat='{}{0:0.00}'}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding DealHigh, StringFormat='{}{0:0.00}'}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding LowPrice, StringFormat='{}{0:0.00}'}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding DealLow, StringFormat='{}{0:0.00}'}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding HighLow, StringFormat='{}{0:0.00}'}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Reference, StringFormat='{}{0:0.00}'}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding LastClosePrice, StringFormat='{}{0:0.00}'}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding OpenLastCloseUpDown, StringFormat='{}{0:0.00}'}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Simulate}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding TotalQty}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding TradeDate, StringFormat='{}{0:MM/dd}'}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding HighPriceLimit, StringFormat='{}{0:0.00}'}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding LowPriceLimit, StringFormat='{}{0:0.00}'}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding UpdateTime, StringFormat='{}{0:HH:mm:ss.fff}'}" IsReadOnly="True" CanUserSort="False"/>
                                    <DataGridTextColumn Binding="{Binding Updater}" IsReadOnly="True" CanUserSort="False"/>
                                    <DataGridTextColumn Binding="{Binding Count}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Index}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Market}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding DecimalPos}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding TotalQtyBefore}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Recovered}" IsReadOnly="True" CanUserSort="False"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>
                    <TabItem Header="T字報價">
                        <Grid Background="#FFE5E5E5">
                        </Grid>
                    </TabItem>
                </TabControl>
                <StatusBar DockPanel.Dock="Bottom" VerticalAlignment="Bottom" Height="28">
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemAB1" Text="AB1"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemAB2" Text="AB2"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemAB3" Text="AB3"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemAB4" Text="AB4"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemAB5" Text="AB5"/>
                    </StatusBarItem>
                </StatusBar>
            </Grid>
        </Border>
        <Border Grid.Row="1" Grid.Column="1" Margin="2">
            <Grid Background="#FFE5E5E5">
                <Button x:Name="ButtonSaveTriggerRule" Content="儲存觸價條件" HorizontalAlignment="Left" Margin="10,35,0,0" VerticalAlignment="Top" Click="ButtonSaveTriggerRule_Click"/>
                <Label Content="自定義觸價唯一鍵" HorizontalAlignment="Left" Margin="91,8,0,0" VerticalAlignment="Top"/>
                <TextBox x:Name="TextBoxTriggerPrimaryKey" Text="自定義觸價唯一鍵" ToolTip="自定義觸價唯一鍵" HorizontalAlignment="Left" Margin="91,35,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120"/>
                <Label Content="觸價商品代碼" HorizontalAlignment="Left" Margin="216,8,0,0" VerticalAlignment="Top"/>
                <ComboBox x:Name="ComboBoxTriggerProduct" ToolTip="{Binding Path=SelectedItem.SymbolAndName, RelativeSource={RelativeSource Self}}" HorizontalAlignment="Left" Margin="216,33,0,0" VerticalAlignment="Top" Width="120">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding SymbolAndName}"/>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>
                <Label Content="觸價商品欄位" HorizontalAlignment="Left" Margin="341,8,0,0" VerticalAlignment="Top"/>
                <ComboBox x:Name="ComboBoxTriggerColumn" ToolTip="{Binding Path=SelectedItem.ToolTip, RelativeSource={RelativeSource Self}}" HorizontalAlignment="Left" Margin="341,33,0,0" VerticalAlignment="Top" Width="120">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding DisplayName}" ToolTip="{Binding ToolTip}"/>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>
                <Label Content="大於小於等於數值" HorizontalAlignment="Left" Margin="466,8,0,0" VerticalAlignment="Top"/>
                <TextBox x:Name="TextBoxTriggerRuleValue" Text="大於小於等於數值" ToolTip="系統會自動補上等於" HorizontalAlignment="Left" Margin="466,35,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120"/>
                <Label Content="觸價後取消監控" HorizontalAlignment="Left" Margin="591,8,0,0" VerticalAlignment="Top"/>
                <ComboBox x:Name="ComboBoxTriggerCancel" ToolTip="{Binding Path=SelectedValue, RelativeSource={RelativeSource Self}}" HorizontalAlignment="Left" Margin="591,33,0,0" VerticalAlignment="Top" Width="120"/>
                <Label Content="觸價後執行策略" HorizontalAlignment="Left" Margin="716,8,0,0" VerticalAlignment="Top"/>
                <TextBox x:Name="TextBoxTriggerStrategy" Text="觸價後執行策略" ToolTip="觸價後執行策略" HorizontalAlignment="Left" Margin="716,35,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120"/>
                <Label Content="監控時間區間" HorizontalAlignment="Left" Margin="841,8,0,0" VerticalAlignment="Top"/>
                <TextBox x:Name="TextBoxTriggerTimeDuration" Text="監控時間區間" ToolTip="監控時間區間" HorizontalAlignment="Left" Margin="841,35,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120"/>
                <Label Content="股票權證下單帳號" HorizontalAlignment="Left" Margin="91,59,0,0" VerticalAlignment="Top"/>
                <!--https://stackoverflow.com/questions/11259479/how-to-get-tooltip-binding-to-work-with-a-combobox-->
                <!--https://stackoverflow.com/questions/16197928/wpf-combobox-binding-to-observablecollection-->
                <ComboBox x:Name="ComboBoxStockAccs" ToolTip="{Binding Path=SelectedItem.ToolTip, RelativeSource={RelativeSource Self}}" HorizontalAlignment="Left" Margin="91,84,0,0" VerticalAlignment="Top" Width="120">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding DisplayName}" ToolTip="{Binding ToolTip}"/>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>
                <Label Content="國內期權下單帳號" HorizontalAlignment="Left" Margin="216,59,0,0" VerticalAlignment="Top"/>
                <ComboBox x:Name="ComboBoxFuturesAccs" ToolTip="{Binding Path=SelectedItem.ToolTip, RelativeSource={RelativeSource Self}}" HorizontalAlignment="Left" Margin="216,84,0,0" VerticalAlignment="Top" Width="120">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding DisplayName}" ToolTip="{Binding ToolTip}"/>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>
                <Button x:Name="ButtonFuturesOrderTest" Content="期貨委託測試" HorizontalAlignment="Left" Margin="91,110,0,0" VerticalAlignment="Top" Click="ButtonFuturesOrderTest_Click"/>
                <Button x:Name="ButtonOptionsOrderTest" Content="選擇權委測試" HorizontalAlignment="Left" Margin="216,110,0,0" VerticalAlignment="Top" Click="ButtonOptionsOrderTest_Click"/>
                <TabControl x:Name="TabControlBB" Margin="0,150,0,30" SelectedIndex="0">
                    <TabItem Header="觸價警示">
                        <Grid Background="#FFE5E5E5">
                            <DataGrid x:Name="DataGridTriggerRule" Margin="0" AutoGenerateColumns="False" CanUserAddRows="False" SelectionMode="Extended" SelectionUnit="Cell" IsSynchronizedWithCurrentItem="True">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding UpdateTime, StringFormat='{}{0:HH:mm:ss.fff}'}" IsReadOnly="True" CanUserSort="False"/>
                                    <DataGridTextColumn Binding="{Binding StatusStr}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding PrimaryKey}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Symbol}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding ColumnName}" IsReadOnly="True" CanUserSort="False"/>
                                    <DataGridTextColumn Binding="{Binding ColumnProperty}" IsReadOnly="True" CanUserSort="False"/>
                                    <DataGridTextColumn Binding="{Binding ColumnValue, StringFormat='{}{0:0.00####}'}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Rule}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding TargetValue, StringFormat='{}{0:0.00####}'}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding CancelStr}" IsReadOnly="True" CanUserSort="False"/>
                                    <DataGridTextColumn Binding="{Binding Strategy}" IsReadOnly="True" CanUserSort="False"/>
                                    <DataGridTextColumn Binding="{Binding StartTime, StringFormat='{}{0:MM/dd HH:mm:ss}'}" IsReadOnly="True" CanUserSort="False">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding EndTime, StringFormat='{}{0:MM/dd HH:mm:ss}'}" IsReadOnly="True" CanUserSort="False"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>
                    <TabItem Header="策略執行">
                        <Grid Background="#FFE5E5E5">
                        </Grid>
                    </TabItem>
                </TabControl>
                <StatusBar DockPanel.Dock="Bottom" VerticalAlignment="Bottom" Height="28">
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemBB1" Text="BB1"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemBB2" Text="BB2"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemBB3" Text="BB3"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemBB4" Text="BB4"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemBB5" Text="BB5"/>
                    </StatusBarItem>
                </StatusBar>
            </Grid>
        </Border>
        <Border Grid.Row="2" Grid.Column="1" Margin="2">
            <Grid Background="#FFE5E5E5">
                <TabControl x:Name="TabControlCB" Margin="0,0,0,30" SelectedIndex="0">
                    <TabItem Header="委託回報">
                        <Grid Background="#FFE5E5E5">
                        </Grid>
                    </TabItem>
                    <TabItem Header="成交回報">
                        <Grid Background="#FFE5E5E5">
                        </Grid>
                    </TabItem>
                    <TabItem Header="庫存未平倉">
                        <Grid Background="#FFE5E5E5">
                        </Grid>
                    </TabItem>
                </TabControl>
                <StatusBar DockPanel.Dock="Bottom" VerticalAlignment="Bottom" Height="28">
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemCB1" Text="CB1"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemCB2" Text="CB2"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemCB3" Text="CB3"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemCB4" Text="CB4"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemCB5" Text="CB5"/>
                    </StatusBarItem>
                </StatusBar>
            </Grid>
        </Border>
    </Grid>
</Window>

<Window x:Class="GNAy.Capital.Trade.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:GNAy.Capital.Trade"
        mc:Ignorable="d"
        Title="MainWindow" Height="990" Width="1760" Activated="Window_Activated" Closing="Window_Closing" Deactivated="Window_Deactivated" FocusableChanged="Window_FocusableChanged" GotFocus="Window_GotFocus" GotKeyboardFocus="Window_GotKeyboardFocus" GotMouseCapture="Window_GotMouseCapture" IsVisibleChanged="Window_IsVisibleChanged" KeyDown="Window_KeyDown" KeyUp="Window_KeyUp" Loaded="Window_Loaded" LocationChanged="Window_LocationChanged" LostFocus="Window_LostFocus" LostKeyboardFocus="Window_LostKeyboardFocus" LostMouseCapture="Window_LostMouseCapture" MouseDoubleClick="Window_MouseDoubleClick" MouseDown="Window_MouseDown" MouseEnter="Window_MouseEnter" MouseLeave="Window_MouseLeave" MouseLeftButtonDown="Window_MouseLeftButtonDown" MouseLeftButtonUp="Window_MouseLeftButtonUp" MouseMove="Window_MouseMove" MouseRightButtonDown="Window_MouseRightButtonDown" MouseRightButtonUp="Window_MouseRightButtonUp" MouseUp="Window_MouseUp" PreviewMouseWheel="Window_PreviewMouseWheel" SizeChanged="Window_SizeChanged" StateChanged="Window_StateChanged" ToolTipClosing="Window_ToolTipClosing" ToolTipOpening="Window_ToolTipOpening">
    <Grid>
        <!--https://dotblogs.com.tw/clark/2013/03/31/99679-->
        <!--http://www.skcircle.com/?id=1113-->
        <Grid.RowDefinitions>
            <RowDefinition x:Name="RowDef1" Height="300"/>
            <RowDefinition x:Name="RowDef2" Height="350"/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition x:Name="ColumnDef" Width="750"/>
            <ColumnDefinition/>
        </Grid.ColumnDefinitions>
        <GridSplitter Grid.Row="0" Grid.Column="0" Grid.RowSpan="3" HorizontalAlignment="Right" VerticalAlignment="Stretch" Width="6" Background="Blue"/>
        <GridSplitter Grid.Row="0" Grid.Column="0" HorizontalAlignment="Stretch" VerticalAlignment="Bottom" Height="6" Background="Blue"/>
        <GridSplitter Grid.Row="0" Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Bottom" Height="6" Background="Blue"/>
        <GridSplitter Grid.Row="1" Grid.Column="0" HorizontalAlignment="Stretch" VerticalAlignment="Bottom" Height="6" Background="Blue"/>
        <GridSplitter Grid.Row="1" Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Bottom" Height="6" Background="Blue"/>
        <Border Grid.Row="0" Grid.Column="0" Margin="2">
            <Grid Background="#FFE5E5E5" x:Name="GridAA">
                <TabControl x:Name="TabControlAA" Margin="0,0,0,30" SelectedIndex="0">
                    <TabItem Header="初始化">
                        <Grid Background="#FFE5E5E5">
                            <Label Content="會員帳號" HorizontalAlignment="Left" Margin="33,6,0,0" VerticalAlignment="Top"/>
                            <TextBox x:Name="TextBoxUserID" Text="" ToolTip="會員帳號" HorizontalAlignment="Left" Margin="91,10,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"/>
                            <Label Content="會員密碼" HorizontalAlignment="Left" Margin="33,28,0,0" VerticalAlignment="Top"/>
                            <PasswordBox x:Name="DWPBox" ToolTip="會員密碼" HorizontalAlignment="Left" Margin="91,32,0,0" VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"/>
                            <Button x:Name="ButtonLoginUser" Content="登入會員帳號" HorizontalAlignment="Left" Margin="54,54,0,0" VerticalAlignment="Top" Click="ButtonLoginUser_Click"/>
                            <Button x:Name="ButtonLoginQuote" Content="登入報價元件" HorizontalAlignment="Left" Margin="135,54,0,0" VerticalAlignment="Top" Click="ButtonLoginQuote_Click"/>
                            <Button x:Name="ButtonIsConnected" Content="IsConnected" HorizontalAlignment="Left" Margin="55,78,0,0" VerticalAlignment="Top" Click="ButtonIsConnected_Click"/>
                            <Button x:Name="ButtonDisconnect" Content="Disconnect" HorizontalAlignment="Left" Margin="144,78,0,0" VerticalAlignment="Top" Click="ButtonDisconnect_Click"/>
                            <Button x:Name="ButtonGetProductInfo" Content="商品基本資料" HorizontalAlignment="Left" Margin="54,102,0,0" VerticalAlignment="Top" Click="ButtonGetProductInfo_Click"/>
                            <Button x:Name="ButtonSubQuotes" Content="訂閱即時報價" HorizontalAlignment="Left" Margin="135,102,0,0" VerticalAlignment="Top" Click="ButtonSubQuotes_Click"/>
                            <TextBox x:Name="TextBoxRecoverQuotes" Text="回補報價商品代碼" ToolTip="回補報價商品儲存到檔案" HorizontalAlignment="Left" Margin="10,127,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"/>
                            <Button x:Name="ButtonRecoverQuotes" Content="回補報價商品" ToolTip="回補報價商品儲存到檔案" HorizontalAlignment="Left" Margin="135,126,0,0" VerticalAlignment="Top" Click="ButtonRecoverQuotes_Click"/>
                            <Button x:Name="ButtonRequestKLine" Content="查詢KLine" HorizontalAlignment="Left" Margin="152,150,0,0" VerticalAlignment="Top" Click="ButtonRequestKLine_Click"/>
                            <TextBox x:Name="TextBoxQuoteFolderTest" Text="報價資料夾測試用" ToolTip="測試儲存報價到此資料夾" HorizontalAlignment="Left" Margin="10,175,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"/>
                            <Button x:Name="ButtonSaveQuotesTest" Content="儲存報價資料" HorizontalAlignment="Left" Margin="135,174,0,0" VerticalAlignment="Top" Click="ButtonSaveQuotesTest_Click"/>
                            <Button x:Name="ButtonReadCertification" Content="讀取下單憑證" HorizontalAlignment="Left" Margin="216,54,0,0" VerticalAlignment="Top" Click="ButtonReadCertification_Click"/>
                            <Button x:Name="ButtonGetOrderAccs" Content="取得下單帳號" HorizontalAlignment="Left" Margin="297,54,0,0" VerticalAlignment="Top" Click="ButtonGetOrderAccs_Click"/>
                            <Button x:Name="ButtonUnlockOrder" Content="下單解鎖" HorizontalAlignment="Left" Margin="240,78,0,0" VerticalAlignment="Top" Click="ButtonUnlockOrder_Click"/>
                            <Button x:Name="ButtonGetOpenInterest" Content="期權未平倉" HorizontalAlignment="Left" Margin="309,78,0,0" VerticalAlignment="Top" Click="ButtonGetOpenInterest_Click"/>
                            <Button x:Name="ButtonSetOrderMaxQty" Content="限制委託量" HorizontalAlignment="Left" Margin="228,102,0,0" VerticalAlignment="Top" Click="ButtonSetOrderMaxQty_Click"/>
                            <Button x:Name="ButtonSetOrderMaxCount" Content="限制委託筆數" HorizontalAlignment="Left" Margin="297,102,0,0" VerticalAlignment="Top" Click="ButtonSetOrderMaxCount_Click"/>
                        </Grid>
                    </TabItem>
                    <TabItem Header="行事曆">
                        <Grid Background="#FFE5E5E5">
                        </Grid>
                    </TabItem>
                </TabControl>
                <!--https://stackoverflow.com/questions/2311458/wpf-statusbar-is-not-positioned-at-the-bottom-of-the-window-->
                <StatusBar DockPanel.Dock="Bottom" VerticalAlignment="Bottom" Height="28">
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemAA1" Text="AA1"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemAA2" Text="AA2"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemAA3" Text="AA3"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemAA4" Text="AA4"/>
                    </StatusBarItem>
                </StatusBar>
            </Grid>
        </Border>
        <Border Grid.Row="1" Grid.Column="0" Margin="2">
            <Grid Background="#FFE5E5E5" x:Name="GridBA">
                <TabControl x:Name="TabControlBA" Margin="0,0,0,30" SelectedIndex="0">
                    <TabItem Header="API回覆">
                        <Grid Background="#FFE5E5E5">
                            <DataGrid x:Name="DataGridAPIReply" Margin="0" AutoGenerateColumns="False" CanUserAddRows="False" SelectionMode="Extended" SelectionUnit="Cell" IsSynchronizedWithCurrentItem="True">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding CreatedTime}"/>
                                    <DataGridTextColumn Binding="{Binding ThreadID}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding CallerLineNumber}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding CallerMemberName}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding UserID}"/>
                                    <DataGridTextColumn Binding="{Binding Message}"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>
                </TabControl>
                <StatusBar DockPanel.Dock="Bottom" VerticalAlignment="Bottom" Height="28">
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemBA1" Text="BA1"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemBA2" Text="BA2"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemBA3" Text="BA3"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemBA4" Text="BA4"/>
                    </StatusBarItem>
                </StatusBar>
            </Grid>
        </Border>
        <Border Grid.Row="2" Grid.Column="0" Margin="2">
            <Grid Background="#FFE5E5E5" x:Name="GridCA">
                <TabControl x:Name="TabControlCA" Margin="0,0,0,30" SelectedIndex="0">
                    <TabItem Header="AppLog">
                        <Grid Background="#FFE5E5E5">
                            <DataGrid x:Name="DataGridAppLog" Margin="0" AutoGenerateColumns="False" CanUserAddRows="False" SelectionMode="Extended" SelectionUnit="Cell" IsSynchronizedWithCurrentItem="True">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding CreatedTime}"/>
                                    <DataGridTextColumn Binding="{Binding Level}">
                                        <!--https://stackoverflow.com/questions/5549617/change-datagrid-cell-colour-based-on-values-->
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Style.Triggers>
                                                    <Trigger Property="Text" Value="WARN">
                                                        <Setter Property="Background" Value="Khaki"/>
                                                    </Trigger>
                                                    <Trigger Property="Text" Value="ERROR">
                                                        <Setter Property="Background" Value="Pink"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding ThreadID}">
                                        <!--https://stackoverflow.com/questions/18177153/text-alignment-in-datagrid-->
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding CallerLineNumber}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding CallerMemberName}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Message}"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>
                </TabControl>
                <StatusBar DockPanel.Dock="Bottom" VerticalAlignment="Bottom" Height="28">
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemCA1" Text="CA1"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemCA2" Text="CA2"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemCA3" Text="CA3"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemCA4" Text="CA4"/>
                    </StatusBarItem>
                </StatusBar>
            </Grid>
        </Border>
        <Border Grid.Row="0" Grid.Column="1" Margin="2">
            <Grid Background="#FFE5E5E5" x:Name="GridAB">
                <TabControl x:Name="TabControlAB" Margin="0,0,0,30" SelectedIndex="0">
                    <TabItem Header="一般報價">
                        <Grid Background="#FFE5E5E5">
                            <DataGrid x:Name="DataGridQuoteSubscribed" Margin="0" AutoGenerateColumns="False" CanUserAddRows="False" SelectionMode="Extended" SelectionUnit="Cell" IsSynchronizedWithCurrentItem="True">
                                <DataGrid.RowStyle>
                                    <!--https://stackoverflow.com/questions/18053281/how-to-set-datagrids-row-background-based-on-a-property-value-using-data-bindi-->
                                    <Style TargetType="DataGridRow">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding RowBackground}" Value="1">
                                                <Setter Property="Background" Value="Pink"></Setter>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding RowBackground}" Value="0">
                                                <Setter Property="Background" Value="PaleGreen"></Setter>
                                            </DataTrigger>
                                            <!--試撮-->
                                            <DataTrigger Binding="{Binding RowBackground}" Value="3">
                                                <Setter Property="Background" Value="Plum"></Setter>
                                            </DataTrigger>
                                            <!--試撮-->
                                            <DataTrigger Binding="{Binding RowBackground}" Value="2">
                                                <Setter Property="Background" Value="GreenYellow"></Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGrid.RowStyle>
                                <DataGrid.Columns>
                                    <!--https://blog.csdn.net/yiyi0608/article/details/75597476-->
                                    <DataGridTextColumn Binding="{Binding Page}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Symbol}"/>
                                    <DataGridTextColumn Binding="{Binding Name}"/>
                                    <DataGridTextColumn Binding="{Binding MatchedTimeHHmmss}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding MatchedTimefff}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding DealPrice}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding DealQty}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding UpDown}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding UpDownPct}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding BestBuyPrice}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding BestBuyQty}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding BestSellPrice}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding BestSellQty}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding OpenPrice}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding OpenUpDown}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding HighPrice}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding DealHigh}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding LowPrice}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding DealLow}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding HighLow}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Reference}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding LastClosePrice}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding OpenLastCloseUpDown}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Simulate}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding TotalQty}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding TradeDate}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Updater}"/>
                                    <DataGridTextColumn Binding="{Binding UpdateTime}"/>
                                    <DataGridTextColumn Binding="{Binding Count}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding HighPriceLimit}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding LowPriceLimit}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Index}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding MarketGroupEnum}"/>
                                    <DataGridTextColumn Binding="{Binding DecimalPos}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding TotalQtyBefore}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Recovered}"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>
                    <TabItem Header="T字報價">
                        <Grid Background="#FFE5E5E5">
                        </Grid>
                    </TabItem>
                </TabControl>
                <StatusBar DockPanel.Dock="Bottom" VerticalAlignment="Bottom" Height="28">
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemAB1" Text="AB1"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemAB2" Text="AB2"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemAB3" Text="AB3"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemAB4" Text="AB4"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemAB5" Text="AB5"/>
                    </StatusBarItem>
                </StatusBar>
            </Grid>
        </Border>
        <Border Grid.Row="1" Grid.Column="1" Margin="2">
            <Grid Background="#FFE5E5E5" x:Name="GridBB">
                <Button x:Name="ButtonCancelTrigger" Content="取消觸價監控" HorizontalAlignment="Left" Margin="10,11,0,0" VerticalAlignment="Top" Click="ButtonCancelTrigger_Click"/>
                <Button x:Name="ButtonSaveTriggerRule" Content="儲存觸價條件" HorizontalAlignment="Left" Margin="10,35,0,0" VerticalAlignment="Top" Click="ButtonSaveTriggerRule_Click"/>
                <Label Content="自定義觸價唯一鍵" HorizontalAlignment="Left" Margin="91,8,0,0" VerticalAlignment="Top"/>
                <TextBox x:Name="TextBoxTriggerPrimaryKey" Text="自定義觸價唯一鍵" ToolTip="自定義觸價唯一鍵" HorizontalAlignment="Left" Margin="91,35,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"/>
                <Label Content="觸價商品代碼" HorizontalAlignment="Left" Margin="216,8,0,0" VerticalAlignment="Top"/>
                <ComboBox x:Name="ComboBoxTriggerProduct" ToolTip="{Binding Path=SelectedItem.SymbolAndName, RelativeSource={RelativeSource Self}}" HorizontalAlignment="Left" Margin="216,33,0,0" VerticalAlignment="Top" Width="120">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding SymbolAndName}"/>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>
                <Label Content="觸價商品欄位" HorizontalAlignment="Left" Margin="341,8,0,0" VerticalAlignment="Top"/>
                <ComboBox x:Name="ComboBoxTriggerColumn" ToolTip="{Binding Path=SelectedItem.ToolTip, RelativeSource={RelativeSource Self}}" HorizontalAlignment="Left" Margin="341,33,0,0" VerticalAlignment="Top" Width="120">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding DisplayName}" ToolTip="{Binding ToolTip}"/>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>
                <Label Content="大於小於等於數值" HorizontalAlignment="Left" Margin="466,8,0,0" VerticalAlignment="Top"/>
                <TextBox x:Name="TextBoxTriggerRuleValue" Text="大於小於等於數值" ToolTip="系統會自動補上等於" HorizontalAlignment="Left" Margin="466,35,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"/>
                <Label Content="觸價後取消監控" HorizontalAlignment="Left" Margin="591,8,0,0" VerticalAlignment="Top"/>
                <ComboBox x:Name="ComboBoxTriggerCancel" ToolTip="{Binding Path=SelectedValue, RelativeSource={RelativeSource Self}}" HorizontalAlignment="Left" Margin="591,33,0,0" VerticalAlignment="Top" Width="120"/>
                <TextBox x:Name="TextBoxTriggerStrategyOR" Text="單一觸價即執行策略" ToolTip="滿足單一觸價條件即執行策略" HorizontalAlignment="Left" Margin="716,18,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"/>
                <TextBox x:Name="TextBoxTriggerStrategyAND" Text="全部觸價再執行策略" ToolTip="滿足全部觸價條件再執行策略" HorizontalAlignment="Left" Margin="716,35,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"/>
                <Label Content="監控時間區間" HorizontalAlignment="Left" Margin="841,8,0,0" VerticalAlignment="Top"/>
                <TextBox x:Name="TextBoxTriggerTimeDuration" Text="監控時間區間" ToolTip="監控時間區間" HorizontalAlignment="Left" Margin="841,35,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"/>
                <Button x:Name="ButtonCancelStrategy" Content="取消策略監控" HorizontalAlignment="Left" Margin="10,60,0,0" VerticalAlignment="Top" Click="ButtonCancelStrategy_Click"/>
                <Button x:Name="ButtonSaveStrategyRule" Content="儲存策略條件" HorizontalAlignment="Left" Margin="10,82,0,0" VerticalAlignment="Top" Click="ButtonSaveStrategyRule_Click"/>
                <Label Content="自定義策略唯一鍵" HorizontalAlignment="Left" Margin="91,57,0,0" VerticalAlignment="Top"/>
                <TextBox x:Name="TextBoxStrategyPrimaryKey" Text="自定義策略唯一鍵" ToolTip="自定義策略唯一鍵" HorizontalAlignment="Left" Margin="91,82,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"/>
                <Label Content="停損價差(%)" HorizontalAlignment="Left" Margin="216,57,0,0" VerticalAlignment="Top"/>
                <TextBox x:Name="TextBoxStrategyStopLoss" Text="停損價差(%)" ToolTip="停損價差(%)" HorizontalAlignment="Left" Margin="216,82,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"/>
                <Label Content="停利價差(%)" HorizontalAlignment="Left" Margin="341,57,0,0" VerticalAlignment="Top"/>
                <TextBox x:Name="TextBoxStrategyStopWin" Text="停利價差(%)" ToolTip="停利價差(%)" HorizontalAlignment="Left" Margin="341,82,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"/>
                <TextBox x:Name="TextBoxStrategyMoveStopWin" Text="移動停利價差(%)" ToolTip="移動停利價差(%)" HorizontalAlignment="Left" Margin="341,99,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"/>
                <Label Content="停損後執行" HorizontalAlignment="Left" Margin="466,57,0,0" VerticalAlignment="Top"/>
                <TextBox x:Name="TextBoxTriggerAfterStopLoss" Text="停損後執行觸價" ToolTip="停損後接續執行觸價" HorizontalAlignment="Left" Margin="466,82,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"/>
                <TextBox x:Name="TextBoxStrategyAfterStopLoss" Text="停損後執行策略" ToolTip="停損後接續執行策略" HorizontalAlignment="Left" Margin="466,99,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"/>
                <Label Content="停利後執行" HorizontalAlignment="Left" Margin="591,57,0,0" VerticalAlignment="Top"/>
                <TextBox x:Name="TextBoxTriggerAfterStopWin" Text="停利後執行觸價" ToolTip="停利後接續執行觸價" HorizontalAlignment="Left" Margin="591,82,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"/>
                <TextBox x:Name="TextBoxStrategyAfterStopWin" Text="停利後執行策略" ToolTip="停利後接續執行策略" HorizontalAlignment="Left" Margin="591,99,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"/>
                <Label Content="收盤獲利減倉或CD單" HorizontalAlignment="Left" Margin="716,57,0,0" VerticalAlignment="Top"/>
                <TextBox x:Name="TextBoxStrategyOffsetWin" Text="CD:seconds" ToolTip="收盤對獲利部位做減倉，或CD單" HorizontalAlignment="Left" Margin="716,82,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"/>
                <Label Content="收盤損失減倉" HorizontalAlignment="Left" Margin="841,57,0,0" VerticalAlignment="Top"/>
                <TextBox x:Name="TextBoxStrategyOffsetLoss" Text="收盤損失減倉" ToolTip="收盤對損失部位做減倉" HorizontalAlignment="Left" Margin="841,82,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"/>
                <TabControl x:Name="TabControlBB" Margin="0,110,0,30" SelectedIndex="0">
                    <TabItem Header="觸價警示">
                        <Grid Background="#FFE5E5E5">
                            <DataGrid x:Name="DataGridTriggerRule" Margin="0" AutoGenerateColumns="False" CanUserAddRows="False" SelectionMode="Extended" SelectionUnit="Cell" IsSynchronizedWithCurrentItem="True">
                                <DataGrid.Resources>
                                    <Style TargetType="{x:Type DataGridCell}">
                                        <EventSetter Event="MouseDoubleClick" Handler="DataGridTriggerRuleCell_MouseDoubleClick"/>
                                    </Style>
                                </DataGrid.Resources>
                                <DataGrid.RowStyle>
                                    <Style TargetType="DataGridRow">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Status}" Value="3">
                                                <Setter Property="Background" Value="Pink"></Setter>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="1">
                                                <Setter Property="Background" Value="LightGray"></Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGrid.RowStyle>
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding Updater}"/>
                                    <DataGridTextColumn Binding="{Binding UpdateTime}"/>
                                    <DataGridTextColumn Binding="{Binding StatusDes}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding PrimaryKey}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Symbol}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding ColumnName}"/>
                                    <DataGridTextColumn Binding="{Binding ColumnProperty}"/>
                                    <DataGridTextColumn Binding="{Binding ColumnValue}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding Rule}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding TargetValue}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding CancelDes}"/>
                                    <DataGridTextColumn Binding="{Binding StrategyOR}"/>
                                    <DataGridTextColumn Binding="{Binding StrategyAND}"/>
                                    <DataGridTextColumn Binding="{Binding StartTime}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding EndTime}"/>
                                    <DataGridTextColumn Binding="{Binding Comment}"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>
                    <TabItem Header="策略執行">
                        <Grid Background="#FFE5E5E5">
                            <DataGrid x:Name="DataGridStrategyRule" Margin="0" AutoGenerateColumns="False" CanUserAddRows="False" SelectionMode="Extended" SelectionUnit="Cell" IsSynchronizedWithCurrentItem="True">
                                <DataGrid.Resources>
                                    <Style TargetType="{x:Type DataGridCell}">
                                        <EventSetter Event="MouseDoubleClick" Handler="DataGridStrategyRuleCell_MouseDoubleClick"/>
                                    </Style>
                                </DataGrid.Resources>
                                <!--<DataGrid.RowStyle>
                                    <Style TargetType="DataGridRow">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Status}" Value="3">
                                                <Setter Property="Background" Value="Pink"></Setter>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="1">
                                                <Setter Property="Background" Value="LightGray"></Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGrid.RowStyle>-->
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding Updater}"/>
                                    <DataGridTextColumn Binding="{Binding UpdateTime}"/>
                                    <DataGridTextColumn Binding="{Binding StatusDes}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding PrimaryKey}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding MarketName}"/>
                                    <DataGridTextColumn Binding="{Binding FullAccount}"/>
                                    <DataGridTextColumn Binding="{Binding Symbol}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding BSDes}"/>
                                    <DataGridTextColumn Binding="{Binding TradeTypeDes}"/>
                                    <DataGridTextColumn Binding="{Binding DayTradeDes}"/>
                                    <DataGridTextColumn Binding="{Binding PositionDes}"/>
                                    <DataGridTextColumn Binding="{Binding MarketPrice}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding OrderPriceBefore}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding OrderPriceAfter}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding OrderQty}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding StopLossBefore}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding StopLossAfter}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding StopWinBefore}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding StopWinAfter}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding MoveStopWinBefore}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding MoveStopWinAfter}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding OrderReport}"/>
                                    <DataGridTextColumn Binding="{Binding DealPrice}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding DealQty}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding DealPct}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding DealReport}"/>
                                    <DataGridTextColumn Binding="{Binding TriggerAfterStopLoss}"/>
                                    <DataGridTextColumn Binding="{Binding StrategyAfterStopLoss}"/>

                                    <DataGridTextColumn Binding="{Binding Comment}"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>
                </TabControl>
                <StatusBar DockPanel.Dock="Bottom" VerticalAlignment="Bottom" Height="28">
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemBB1" Text="BB1"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemBB2" Text="BB2" Background="Pink"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemBB3" Text="BB3" Background="Pink"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemBB4" Text="BB4"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemBB5" Text="BB5"/>
                    </StatusBarItem>
                </StatusBar>
            </Grid>
        </Border>
        <Border Grid.Row="2" Grid.Column="1" Margin="2">
            <Grid Background="#FFE5E5E5" x:Name="GridCB">
                <Label Content="個別市場下單帳號" HorizontalAlignment="Left" Margin="10,10,0,0" VerticalAlignment="Top"/>
                <!--https://stackoverflow.com/questions/11259479/how-to-get-tooltip-binding-to-work-with-a-combobox-->
                <!--https://stackoverflow.com/questions/16197928/wpf-combobox-binding-to-observablecollection-->
                <ComboBox x:Name="ComboBoxOrderAccs" ToolTip="{Binding Path=SelectedItem.ToolTip, RelativeSource={RelativeSource Self}}" HorizontalAlignment="Left" Margin="10,35,0,0" VerticalAlignment="Top" Width="120">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding DisplayName}" ToolTip="{Binding ToolTip}"/>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>
                <Label Content="下單商品代碼" HorizontalAlignment="Left" Margin="135,8,0,0" VerticalAlignment="Top"/>
                <ComboBox x:Name="ComboBoxOrderProduct" HorizontalAlignment="Left" Margin="135,35,0,0" VerticalAlignment="Top" Width="120" IsEditable="True"></ComboBox>
                <Label Content="Buy/Sell" HorizontalAlignment="Left" Margin="260,10,0,0" VerticalAlignment="Top"/>
                <ComboBox x:Name="ComboBoxOrderBuySell" ToolTip="{Binding Path=SelectedValue, RelativeSource={RelativeSource Self}}" HorizontalAlignment="Left" Margin="260,35,0,0" VerticalAlignment="Top" Width="120"/>
                <Label Content="掛單類型" HorizontalAlignment="Left" Margin="385,10,0,0" VerticalAlignment="Top"/>
                <ComboBox x:Name="ComboBoxOrderTradeType" ToolTip="{Binding Path=SelectedValue, RelativeSource={RelativeSource Self}}" HorizontalAlignment="Left" Margin="385,35,0,0" VerticalAlignment="Top" Width="120"/>
                <Label Content="是否當沖" HorizontalAlignment="Left" Margin="510,10,0,0" VerticalAlignment="Top"/>
                <ComboBox x:Name="ComboBoxOrderDayTrade" ToolTip="{Binding Path=SelectedValue, RelativeSource={RelativeSource Self}}" HorizontalAlignment="Left" Margin="510,35,0,0" VerticalAlignment="Top" Width="120"/>
                <Label Content="新倉平倉自動" HorizontalAlignment="Left" Margin="635,10,0,0" VerticalAlignment="Top"/>
                <ComboBox x:Name="ComboBoxOrderPositionKind" ToolTip="{Binding Path=SelectedValue, RelativeSource={RelativeSource Self}}" HorizontalAlignment="Left" Margin="635,35,0,0" VerticalAlignment="Top" Width="120"/>
                <Button x:Name="ButtonSendFutureOrder" Content="期貨委託送出" HorizontalAlignment="Left" Margin="54,61,0,0" VerticalAlignment="Top" Click="ButtonSendFutureOrder_Click"/>
                <Button x:Name="ButtonStartFutureStartegyNow" Content="立刻啟動策略" HorizontalAlignment="Left" Margin="54,82,0,0" VerticalAlignment="Top" Click="ButtonStartFutureStartegyNow_Click"/>
                <Label Content="委託價格" HorizontalAlignment="Left" Margin="135,57,0,0" VerticalAlignment="Top"/>
                <TextBox x:Name="TextBoxOrderPrice" Text="M市價，P範圍市價" ToolTip="M市價，P範圍市價" HorizontalAlignment="Left" Margin="135,82,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"/>
                <Label Content="委託口數" HorizontalAlignment="Left" Margin="260,57,0,0" VerticalAlignment="Top"/>
                <TextBox x:Name="TextBoxOrderQuantity" Text="委託口數" ToolTip="委託口數" HorizontalAlignment="Left" Margin="260,82,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="120" GotFocus="TextBox_GotFocus"/>
                <Label Content="委託序號" HorizontalAlignment="Left" Margin="452,59,0,0" VerticalAlignment="Top"/>
                <ComboBox x:Name="ComboBoxOrderSeqNo" HorizontalAlignment="Left" Margin="510,61,0,0" VerticalAlignment="Top" Width="120" IsEditable="True"/>
                <Button x:Name="ButtonCancelOrderBySeqNo" Content="刪單by序號" HorizontalAlignment="Left" Margin="635,61,0,0" VerticalAlignment="Top" Click="ButtonCancelOrderBySeqNo_Click"/>
                <Label Content="委託書號" HorizontalAlignment="Left" Margin="452,80,0,0" VerticalAlignment="Top"/>
                <ComboBox x:Name="ComboBoxOrderBookNo" HorizontalAlignment="Left" Margin="510,82,0,0" VerticalAlignment="Top" Width="120" IsEditable="True"/>
                <Button x:Name="ButtonCancelOrderByBookNo" Content="刪單by書號" HorizontalAlignment="Left" Margin="635,82,0,0" VerticalAlignment="Top" Click="ButtonCancelOrderByBookNo_Click"/>
                <TabControl x:Name="TabControlCB" Margin="0,110,0,30" SelectedIndex="0">
                    <TabItem Header="委託成交回報">
                        <Grid Background="#FFE5E5E5">
                            <DataGrid x:Name="DataGridOrderDetail" Margin="0" AutoGenerateColumns="False" CanUserAddRows="False" SelectionMode="Extended" SelectionUnit="Cell" IsSynchronizedWithCurrentItem="True">
                                <DataGrid.Resources>
                                    <Style TargetType="{x:Type DataGridCell}">
                                        <EventSetter Event="MouseDoubleClick" Handler="DataGridOrderDetailCell_MouseDoubleClick"/>
                                    </Style>
                                </DataGrid.Resources>
                                <!--<DataGrid.RowStyle>
                                    <Style TargetType="DataGridRow">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Status}" Value="3">
                                                <Setter Property="Background" Value="Pink"></Setter>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Status}" Value="1">
                                                <Setter Property="Background" Value="LightGray"></Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGrid.RowStyle>-->
                                <DataGrid.Columns>
                                    <DataGridTextColumn Binding="{Binding Updater}"/>
                                    <DataGridTextColumn Binding="{Binding UpdateTime}"/>
                                    <DataGridTextColumn Binding="{Binding StatusDes}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding PrimaryKey}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding MarketName}"/>
                                    <DataGridTextColumn Binding="{Binding FullAccount}"/>
                                    <DataGridTextColumn Binding="{Binding Symbol}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding BSDes}"/>
                                    <DataGridTextColumn Binding="{Binding TradeTypeDes}"/>
                                    <DataGridTextColumn Binding="{Binding DayTradeDes}"/>
                                    <DataGridTextColumn Binding="{Binding PositionDes}"/>
                                    <DataGridTextColumn Binding="{Binding MarketPrice}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="DemiBold"/>
                                                <Setter Property="Foreground" Value="MediumBlue"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding OrderPriceBefore}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding OrderPriceAfter}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding OrderQty}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding StopLossBefore}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding StopLossAfter}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding StopWinBefore}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding StopWinAfter}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding MoveStopWinBefore}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding MoveStopWinAfter}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding OrderReport}"/>
                                    <DataGridTextColumn Binding="{Binding DealPrice}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding DealQty}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding DealPct}">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Binding="{Binding DealReport}"/>
                                    <DataGridTextColumn Binding="{Binding TriggerAfterStopLoss}"/>
                                    <DataGridTextColumn Binding="{Binding StrategyAfterStopLoss}"/>

                                    <DataGridTextColumn Binding="{Binding Comment}"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>
                    <TabItem Header="庫存未平倉">
                        <Grid Background="#FFE5E5E5">
                        </Grid>
                    </TabItem>
                </TabControl>
                <StatusBar DockPanel.Dock="Bottom" VerticalAlignment="Bottom" Height="28">
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemCB1" Text="CB1"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemCB2" Text="CB2" Background="Pink"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemCB3" Text="CB3" Background="Pink"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemCB4" Text="CB4"/>
                    </StatusBarItem>
                    <Separator/>
                    <StatusBarItem>
                        <TextBlock x:Name="StatusBarItemCB5" Text="CB5"/>
                    </StatusBarItem>
                </StatusBar>
            </Grid>
        </Border>
    </Grid>
</Window>
